geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 10),
axis.text.y = element_text(size= 10))+
theme(plot.title = element_text(hjust =0.5))
TNmicrobePlot
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 14),
axis.text.y = element_text(size= 14))+
theme(plot.title = element_text(hjust =0.5))
TNmicrobePlot
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12))+
theme(plot.title = element_text(hjust =0.5))
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TN  over time")+
theme(plot.title = element_text(hjust =0.5))
facet_wrap(~siteID, nrows= 2, scale="free")
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TN  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID, nrows= 2, scale="free")
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TN  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID, scale="free")
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TN  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, scale="free")
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TN  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free_y")
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNmicrobePlot<-swc.tn %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TN  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TNmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
breaks= seq(0,3,0.2),
name= "Total Nitrogen mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TNlinerPlot<- swc.tn %>%
ggplot(aes(x= TN, y= microAbMl))+
geom_point()+
geom_smooth(method = "lm", se = FALSE, color = "red")+
facet_wrap(~siteID.x, scale = "free")
TNlinerPlot
TNlinerPlot
TNlinerPlot<- swc.tn %>%
ggplot(aes(x= TN, y= microAbMl))+
geom_point()+
geom_smooth(method = "lm", se = FALSE, color = "red")+
facet_wrap(~siteID.x, scale = "free")
TNlinerPlot
View(swc.tn)
TNlinerPlot<- swc.tn %>%
ggplot(aes(x= analyteConcentration, y= microAbMl))+
geom_point()+
geom_smooth(method = "lm", se = FALSE, color = "red")+
facet_wrap(~siteID.x, scale = "free")
TNlinerPlot
TNlinerPlot<- swc.tn %>%
ggplot(aes(x= analyteConcentration, y=log10Abundance))+
geom_point()+
geom_smooth(method = "lm", se = FALSE, color = "red")+
facet_wrap(~siteID.x, scale = "free")
TNlinerPlot
View(swc.tn)
View(swc.plot)
swc.tss<-onlySWc.microbe[onlySWc.microbe$analyte=='TSS - Dry Mass',]
View(swc.tss)
swc.plot<-onlySWc.microbe[onlySWc.microbe$analyte %in% c('TN','TP', 'specificConductance', 'TSS'),]
swc.tss<-onlySWc.microbe[onlySWc.microbe$analyte=='TSS ',]
TssmicrobePlot<-swc.tss %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TSS  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TssmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(#breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
#breaks= seq(0,3,0.2),
name= "Total Suspended Sediments mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
swc.tss<-onlySWc.microbe[onlySWc.microbe$analyte=='TSS',]
TssmicrobePlot<-swc.tss %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TSS  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TssmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(#breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
#breaks= seq(0,3,0.2),
name= "Total Suspended Sediments mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TssmicrobePlot<-swc.tss %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TSS  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TssmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~. *0.2 ,
#breaks= seq(0,3,0.2),
name= "Total Suspended Sediments mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TssmicrobePlot<-swc.tss %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TSS  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TssmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~.,
breaks= seq(0,9,1),
name= "Total Suspended Sediments mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TssmicrobePlot<-swc.tss %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TSS  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TssmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(#breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~.,
#breaks= seq(0,9,1),
name= "Total Suspended Sediments mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
TssmicrobePlot<-swc.tss %>%
ggplot(aes(x= date, y=log10Abundance))+
geom_line(color="blue")+
scale_x_date(date_breaks= "1 month",
date_labels="%b-%Y") +
theme(axis.text.x = element_text(angle = 60, hjust = 1, size= 12),
axis.text.y = element_text(size= 12),
axis.title.x = element_text(size=12),
axis.title.y = element_text(size=12))+
labs(title = "Microbial abundance and TSS  over time")+
theme(plot.title = element_text(hjust =0.5))+
facet_wrap(~siteID.x, ncol= 1, scale="free")
TssmicrobePlot +
geom_line(aes(y=analyteConcentration), color= "red") +
scale_y_continuous(#breaks = seq(0,8,1),
name = "log10 of Microbial Abundance per mL",
sec.axis = sec_axis(trans = ~./2,
#breaks= seq(0,9,1),
name= "Total Suspended Sediments mg/L"
)
)+
theme(axis.title.y.left = element_text(color= "blue"),
axis.title.y.right = element_text(color= "red"))
grid.arrange(p1,p2,ncol=2)
library(tidyverse)
library(ggplot2)
library(neonUtilities)
library(tidyr)
library(dplyr)
library(lubridate)
library(stringr)
library(stats)
library(neonOS)
library(plotly)
library(gridExtra)
MicAbund.years_outliers <-ggplot(data = rmOutlier.DMS, aes(x=Month, y= microAbMl, color= Year, group = Year))+
geom_point(size =3)+
geom_line(size=1) +
theme(axis.text.x = element_text(hjust = 1))+
facet_wrap(~siteID, nrows = 2, scale = "free")
MicAbund.years_outliers  +
labs(title = "Microbial Abundance per mL per month from 2017 to 2022")+
theme(plot.title = element_text(hjust =0.5),
axis.text.x = element_text(hjust = 1, size= 14),
axis.text.y = element_text(size= 14),
axis.title.x = element_text(size=14),
axis.title.y = element_text(size=14))
#Pull data from Portal using neonUtilities
dsc<-loadByProduct(dp="DP1.20048.001", site=c("CUPE", "GUIL"),
startdate="2017-01", enddate="2023-04",
package= 'basic', check.size=F, release = 'current')
#write.csv(dsc$dsc_fieldData, "C:/Users/mviggiano/Documents/Github/Fisheries/dsc.csv")
streamFlow<- dsc$dsc_fieldData
short.dsc<- streamFlow%>%
select(siteID, collectDate, streamStage, finalDischarge)
short.dsc$Date<- as.Date((short.dsc$collectDate), format ="%d-%b-%Y")
short.dsc<-subset(short.dsc, select = -c(date))
#merge swc.microbes with dsc
dsc.swc.mic<- merge(swc.microbes, short.dsc, by = "Date", all.x =TRUE)
dsc.combo.all<- dsc.swc.mic %>% drop_na(finalDischarge)
short.dsc
rm(g)
rm(gg)
rm(icroAbunplot)
rm(ingestTableShipQuery)
rm(listOfSampleClasses)
rm(mic)
View(benthEnvo)
View(appReactives)
rm(appReactives)
save.image("~/Github/Mvviggi/swc.mic.dsc.2024.RData")
options(stringsAsFactors=F)
list2env(dsc, .GlobalEnv)
View(variables_20093)
View(variables_20048)
View(variables_00006)
View(validation_20138)
View(validation_20093)
View(validation_20048)
load("~/Github/Mvviggi/DataChallenge_enviro.chlorophyll.int.RData")
#library packages used
library(tidyverse)
library(dplyr)
library(neonUtilities)
library(neonOS)
library(ggplot2)
library(skimr)
periphyton.chla
benbiomass.all<- median.rep.chla %>%
ggplot(aes(boutNumber, mediansampleID, color = algalSampleType))+
geom_point()+
facet_grid(habitatType ~siteID.x +Date, scale = "free")
benbiomass.all + labs(title= "Benthic Algal Chlorophyll Biomass for 2022-2023 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
benbiomass.sampleType<- median.rep.chla %>%
filter(Date == 2022) %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(algalSampleType ~siteID.x, scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
benbiomass.sampleType<- median.rep.chla %>%
filter(Date == 2022, siteID.x == 'CUPE', 'GUIL') %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~siteID.x, scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
benbiomass.sampleType<- median.rep.chla %>%
filter(Date == 2022, siteID.x == 'CUPE' & 'GUIL') %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~siteID.x, scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
rlang::last_trace()
benbiomass.sampleType<- median.rep.chla %>%
filter(Date == 2022, siteID.x = 'CUPE' , 'GUIL') %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~siteID.x, scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
benbiomass.sampleType<- median.rep.chla %>%
filter(Date == 2022, siteID.x == 'CUPE' , siteID.x == 'GUIL') %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~siteID.x, scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
View(median.rep.chla)
benbiomass.sampleType<- median.rep.chla %>%
filter(siteID.x == 'CUPE' , siteID.x == 'GUIL') %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~Date,  scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
rlang::last_trace()
benbiomass.sampleType<- median.rep.chla %>%
filter(siteID.x %in% c('CUPE', 'GUIL')) %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~Date,  scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
View(periphyton.chla)
#exclude algalsample type- only D04 sites
benbiomass.sampleType<- median.rep.chla %>%
filter(siteID.x %in% c('CUPE', 'GUIL')) %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(~Date~siteID.x  scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
benbiomass.sampleType<- median.rep.chla %>%
filter(siteID.x %in% c('CUPE', 'GUIL')) %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(Date~siteID.x  scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
benbiomass.sampleType<- median.rep.chla %>%
filter(siteID.x %in% c('CUPE', 'GUIL')) %>%
ggplot(aes(boutNumber, mediansampleID, color = habitatType))+
geom_boxplot()+
facet_wrap(Date~siteID.x , ncol= 4,  scale = "free")
benbiomass.sampleType + labs(title = "Benthic Algal Chlorophyll Biomass for 2022 in five NEON sites",
y = 'median chla (mg/m2)',
x = 'Sampling bout')
